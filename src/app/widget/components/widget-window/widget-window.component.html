<div class="widget-window"
     #widget
     (mousedown)="incrementZIndex()"
     [ngDraggable]="config.resizable && !state.anchored"
       [handle]="widgetHandle"
       [preventDefaultEvent]="true"
       [zIndex]="state.zIndex"
       (started)="handleDragStart($event)"
       (stopped)="handleDragEnd($event)"
      mwlResizable
       [enableGhostResize]="true"
       (resizeEnd)="handleResizeEnd($event)"
     [style.display]="state.closed ? 'none' : 'block'"
     [style.width]="!state.anchored ? state.size.width + 'px' : '320px'"
     [style.height]="!state.anchored ? (state.folded?20:state.size.height) + 'px': 'auto'"
     [ngClass]="{
        'widget-state-closed': state.closed
      , 'widget-state-open': !state.closed
      , 'widget-state-folded': state.folded
      , 'widget-state-unfolded': !state.folded
      , 'widget-state-anchored': state.anchored
      , 'widget-state-floating': !state.anchored
      }"
     >
  <widget-header
    [(state)]="state"
    [foldable]="config.foldable"
    [closable]="config.closable"
    [anchorable]="config.anchorable"
    (onStateChange)="handleStateChange($event)"
  >
    <div class="widget-handle" #widgetHandle>{{ title }}</div>
  </widget-header>
  <widget-panel *ngIf="!state.folded"
                [size]="state.size"
                [scrollable]="config.scrollable"
                [resizable]="config.resizable && !state.anchored">
    <ng-content></ng-content>
  </widget-panel>
</div>
<!-- conteneur invisible -->
<div *ngIf="contentLoaded" [style.display]="'none'">
  <expand-button
    esriWidget
    [title]="title"
    [iconClass]="icon"
    [position]="position"
    [index]="index"
    [active]="!state.closed"
    (activeChange)="handleActiveChange($event)"
  ></expand-button>
</div>
